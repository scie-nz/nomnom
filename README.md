# tpch_example

TPC-H-style order processing example using nomnom

## Auto-Generated Project

This project was automatically generated by [nomnom](https://github.com/scie-nz/ingestion/tree/main/nomnom),
a YAML-based code generation framework for data transformation libraries.

## Database Support

Nomnom supports **PostgreSQL**, **MySQL**, and **MariaDB** backends. You can select your database backend at code generation time.

### Quick Start

#### PostgreSQL (Default)
```bash
# Generate code for PostgreSQL
nomnom build-from-config --config config/examples/tpch/nomnom.yaml --database postgresql

# Build with PostgreSQL feature
cargo build --features postgres
```

#### MySQL
```bash
# Generate code for MySQL
nomnom build-from-config --config config/examples/tpch/nomnom.yaml --database mysql

# Build with MySQL feature
cargo build --no-default-features --features mysql
```

### Configuration Options

You can specify the database type in three ways (in order of precedence):

1. **CLI Flag** (highest priority)
   ```bash
   nomnom build-from-config --database mysql
   ```

2. **Environment Variable**
   ```bash
   export NOMNOM_DATABASE_TYPE=mysql
   nomnom build-from-config
   ```

3. **Config File** (in `nomnom.yaml`)
   ```yaml
   database:
     type: mysql  # Options: postgresql, mysql, mariadb
   ```

### Database Auto-Detection

Nomnom can automatically detect the database type from `DATABASE_URL`:
```bash
export DATABASE_URL=postgres://localhost/mydb  # Auto-detects PostgreSQL
export DATABASE_URL=mysql://localhost/mydb     # Auto-detects MySQL
```

For more details, see the [Database Configuration Guide](docs/DATABASE_CONFIGURATION.md).

## Building

### Development Build

```bash
maturin develop
```

### Release Build

```bash
maturin build --release
```

## Testing

```bash
pytest tests/
```

## Generated From

This project was generated from YAML entity and transform definitions using:

```bash
nomnom build --config config --output .build --release
```

## Structure

- `src/lib.rs` - Main library entry point
- `src/generated.rs` - Auto-generated entity definitions
- `src/generated_bindings.rs` - Auto-generated PyO3 bindings
- `Cargo.toml` - Rust dependencies and build configuration
- `pyproject.toml` - Python packaging configuration

## License

MIT
